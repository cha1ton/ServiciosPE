<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel de Gestión de Negocio - ServiciosPe</title>
    <link rel="stylesheet" href="dashboard.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <header class="navbar">
        <div class="logo">
            <a href="/dashboard" class="a-logo">
                <span class="logo-icon">SP</span> ServiciosPe</a>
        </div>
        
        <div class="user-actions">
            <a href="/register-provider" class="btn-mi-negocio"><i class="fas fa-briefcase"></i> Mi Negocio</a>
            <div class="dropdown-container">
                <a href="#" class="user-profile" id="userProfileToggle">
                    <img src="<%= user.photo || '/user_placeholder.png' %>" alt="User Avatar" class="user-avatar">
                    <span id="user-name"><%= user.name || 'Usuario' %></span>
                </a>
                <div class="dropdown-menu" id="userDropdown">
                    <a href="/profile" class="dropdown-item"><i class="fas fa-user"></i> Mi Perfil</a>
                    <a href="#" class="dropdown-item"><i class="fas fa-heart"></i> Favoritos</a>
                    <div class="dropdown-divider"></div>
                    <a href="/auth/logout" class="dropdown-item logout-item"><i class="fas fa-sign-out-alt"></i> Cerrar Sesión</a>
                </div>
            </div>
        </div>
    </header>

    <main class="content">
        <div class="manage-service-container">
            <h2>Panel de Gestión: Mi Restaurante Favorito</h2>

            <div class="service-info-block" style="margin-bottom: 30px;">
                <h3><i class="fas fa-edit"></i> Actualizar Información del Servicio</h3>
                <form>
                    <div class="form-group">
                        <label for="businessNameEdit">Nombre del Negocio:</label>
                        <input type="text" id="businessNameEdit" value="Mi Restaurante Favorito">
                    </div>
                    <div class="form-group">
                        <label for="descriptionEdit">Descripción:</label>
                        <textarea id="descriptionEdit" rows="4">Deliciosa comida criolla y marina en un ambiente acogedor, perfecto para toda la familia.</textarea>
                    </div>
                    <div class="form-group">
                        <label for="addressEdit">Dirección:</label>
                        <input type="text" id="addressEdit" value="Av. Los Rosales 123, Santa Anita, Lima">
                    </div>
                    <div class="form-group">
                        <label for="phoneEdit">Teléfono:</label>
                        <input type="tel" id="phoneEdit" value="(01) 456-7890">
                    </div>
                     <div class="form-group">
                        <label for="horariosEdit">Horarios (ej. L-S: 12 PM - 10 PM):</label>
                        <input type="text" id="horariosEdit" value="Lunes a Sábado: 12 PM - 10 PM | Domingos: 12 PM - 6 PM">
                    </div>
                    <div class="form-group">
                        <label>Fotos (arrastrar o click para cambiar):</label>
                        <div class="photo-upload-grid" id="managePhotoUploadGrid">
                            <div class="photo-upload-item has-image">
                                <input type="file" id="mPhoto1" accept="image/*">
                                <label for="mPhoto1"><i class="fas fa-plus"></i> <span>Añadir Foto 1</span></label>
                                <img src="images/restaurante_mock.jpg" alt="Foto 1">
                                <button type="button" class="remove-photo-btn"><i class="fas fa-times"></i></button>
                            </div>
                            <div class="photo-upload-item has-image">
                                <input type="file" id="mPhoto2" accept="image/*">
                                <label for="mPhoto2"><i class="fas fa-plus"></i> <span>Añadir Foto 2</span></label>
                                <img src="images/restaurante_mock_int1.jpg" alt="Foto 2">
                                <button type="button" class="remove-photo-btn"><i class="fas fa-times"></i></button>
                            </div>
                            <div class="photo-upload-item has-image">
                                <input type="file" id="mPhoto3" accept="image/*">
                                <label for="mPhoto3"><i class="fas fa-plus"></i> <span>Añadir Foto 3</span></label>
                                <img src="images/restaurante_mock_int2.jpg" alt="Foto 3">
                                <button type="button" class="remove-photo-btn"><i class="fas fa-times"></i></button>
                            </div>
                            <div class="photo-upload-item">
                                <input type="file" id="mPhoto4" accept="image/*">
                                <label for="mPhoto4"><i class="fas fa-plus"></i> <span>Añadir Foto 4</span></label>
                                <img src="" alt="" style="display:none;">
                                <button type="button" class="remove-photo-btn"><i class="fas fa-times"></i></button>
                            </div>
                        </div>
                    </div>

                    <div class="form-actions">
                        <button type="submit" class="btn-primary" onclick="alert('Información del negocio actualizada (simulado)!'); return false;"><i class="fas fa-save"></i> Guardar Cambios</button>
                    </div>
                </form>
            </div>

            <div class="reviews-section">
                <h3><i class="fas fa-comments"></i> Responder a Reseñas</h3>
                <div class="review-item">
                    <div class="review-header">
                        <span class="review-author">Ana Gómez</span>
                        <span class="review-rating"><span class="stars">★★★★★</span> (5 estrellas)</span>
                        <span class="review-date">01/07/2025</span>
                    </div>
                    <p class="review-text">¡Excelente comida criolla! El ají de gallina es espectacular y la atención muy amable. Volveré pronto.</p>
                    <div class="response-to-review-section">
                        <h4>Tu Respuesta:</h4>
                        <textarea id="response1" placeholder="Escribe tu respuesta aquí..."></textarea>
                        <button class="btn-primary" onclick="alert('Respuesta enviada a Ana Gómez (simulado)!');"><i class="fas fa-reply"></i> Enviar Respuesta</button>
                    </div>
                </div>
                <div class="review-item">
                    <div class="review-header">
                        <span class="review-author">Carlos Torres</span>
                        <span class="review-rating"><span class="stars">★★★★☆</span> (4 estrellas)</span>
                        <span class="review-date">28/06/2025</span>
                    </div>
                    <p class="review-text">Buena sazón, aunque el local estaba un poco lleno. La causa rellena estaba deliciosa.</p>
                    <div class="response-to-review-section">
                        <h4>Tu Respuesta:</h4>
                        <textarea id="response2" placeholder="Escribe tu respuesta aquí..."></textarea>
                        <button class="btn-primary" onclick="alert('Respuesta enviada a Carlos Torres (simulado)!');"><i class="fas fa-reply"></i> Enviar Respuesta</button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const userProfileToggle = document.getElementById('userProfileToggle');
            const userDropdown = document.getElementById('userDropdown');
            if (userProfileToggle && userDropdown) {
                userProfileToggle.addEventListener('click', (e) => {
                    e.preventDefault();
                    userDropdown.classList.toggle('show');
                });
                window.addEventListener('click', (e) => {
                    if (!userProfileToggle.contains(e.target) && !userDropdown.contains(e.target)) {
                        userDropdown.classList.remove('show');
                    }
                });
            }

            // Photo upload simulation for manage service page
            document.querySelectorAll('#managePhotoUploadGrid .photo-upload-item').forEach(item => {
                const input = item.querySelector('input[type="file"]');
                const img = item.querySelector('img');
                const removeBtn = item.querySelector('.remove-photo-btn');

                input.addEventListener('change', function() {
                    const file = this.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = function(e) {
                            img.src = e.target.result;
                            img.style.display = 'block';
                            item.classList.add('has-image');
                        }
                        reader.readAsDataURL(file);
                    }
                });

                removeBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    img.src = '';
                    img.style.display = 'none';
                    item.classList.remove('has-image');
                    input.value = '';
                });
            });
        });
    </script>
</body>
</html>